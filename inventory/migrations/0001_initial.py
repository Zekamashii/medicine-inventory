# Generated by Django 5.1 on 2024-08-14 18:04

import django.core.validators
import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):
    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name="Category",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "name",
                    models.CharField(
                        max_length=50, null=True, unique=True, verbose_name="種類名"
                    ),
                ),
                (
                    "obsoleted",
                    models.BooleanField(
                        default=False,
                        help_text="廃止された項目は、システムから削除されるわけではありませんが、一般的な操作や検索の対象からは除外されます。",
                        verbose_name="廃止する",
                    ),
                ),
                (
                    "date_created",
                    models.DateTimeField(auto_now_add=True, verbose_name="作成日時"),
                ),
                (
                    "user",
                    models.ForeignKey(
                        default=0,
                        on_delete=django.db.models.deletion.PROTECT,
                        to=settings.AUTH_USER_MODEL,
                        verbose_name="作成者",
                    ),
                ),
            ],
            options={
                "verbose_name_plural": "Categories",
                "ordering": ("id",),
            },
        ),
        migrations.CreateModel(
            name="Drug",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "name",
                    models.CharField(
                        help_text="必須。医薬品一般名。例：チオクト酸静注。",
                        max_length=50,
                        unique=True,
                        verbose_name="医薬品名",
                    ),
                ),
                (
                    "kana",
                    models.CharField(
                        blank=True,
                        help_text="自動生成されます。不正確な場合は編集してください。",
                        max_length=100,
                        null=True,
                        unique=True,
                        verbose_name="ふりがな",
                    ),
                ),
                (
                    "description",
                    models.CharField(
                        blank=True,
                        help_text="コメント、注意など。",
                        max_length=100,
                        null=True,
                        verbose_name="説明",
                    ),
                ),
                (
                    "package",
                    models.CharField(
                        blank=True,
                        help_text="例：500mg/錠 PTP 10錠×10。",
                        max_length=50,
                        null=True,
                        verbose_name="包装",
                    ),
                ),
                (
                    "price",
                    models.CharField(
                        choices=[
                            ("L", "低 (<¥5000)"),
                            ("M", "中 (~¥5000)"),
                            ("H", "高 (>¥5000)"),
                        ],
                        default="L",
                        help_text="必須。",
                        max_length=2,
                        verbose_name="値段",
                    ),
                ),
                (
                    "product_code",
                    models.CharField(
                        blank=True, max_length=255, null=True, verbose_name="商品コード"
                    ),
                ),
                (
                    "orca_id",
                    models.CharField(
                        blank=True, max_length=50, null=True, verbose_name="ORCA ID"
                    ),
                ),
                (
                    "date_created",
                    models.DateTimeField(auto_now_add=True, verbose_name="最終更新日時"),
                ),
                (
                    "obsoleted",
                    models.BooleanField(
                        default=False,
                        help_text="廃止された項目は、システムから削除されるわけではありませんが、一般的な操作や検索の対象からは除外されます。",
                        verbose_name="廃止する",
                    ),
                ),
                (
                    "category",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        to="inventory.category",
                        verbose_name="医薬品種類",
                    ),
                ),
                (
                    "user",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.PROTECT,
                        to=settings.AUTH_USER_MODEL,
                        verbose_name="最終更新者",
                    ),
                ),
            ],
            options={
                "ordering": ("id",),
            },
        ),
        migrations.CreateModel(
            name="Site",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "name",
                    models.CharField(
                        max_length=100, null=True, unique=True, verbose_name="拠点名"
                    ),
                ),
                (
                    "address",
                    models.CharField(
                        blank=True, max_length=255, null=True, verbose_name="住所"
                    ),
                ),
                (
                    "color",
                    models.CharField(
                        blank=True,
                        help_text="16進数カラーコード。例：#3B4252。",
                        max_length=20,
                        null=True,
                        verbose_name="テーマ色",
                    ),
                ),
                (
                    "obsoleted",
                    models.BooleanField(
                        default=False,
                        help_text="廃止された項目は、システムから削除されるわけではありませんが、一般的な操作や検索の対象からは除外されます。",
                        verbose_name="廃止する",
                    ),
                ),
                (
                    "date_created",
                    models.DateTimeField(auto_now_add=True, verbose_name="作成日時"),
                ),
                (
                    "user",
                    models.ForeignKey(
                        default=0,
                        on_delete=django.db.models.deletion.PROTECT,
                        to=settings.AUTH_USER_MODEL,
                        verbose_name="作成者",
                    ),
                ),
            ],
            options={
                "ordering": ("id",),
            },
        ),
        migrations.CreateModel(
            name="Unit",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "name",
                    models.CharField(
                        max_length=10, null=True, unique=True, verbose_name="単位"
                    ),
                ),
                (
                    "date_created",
                    models.DateTimeField(auto_now_add=True, verbose_name="作成日時"),
                ),
                (
                    "user",
                    models.ForeignKey(
                        default=0,
                        on_delete=django.db.models.deletion.PROTECT,
                        to=settings.AUTH_USER_MODEL,
                        verbose_name="作成者",
                    ),
                ),
            ],
            options={
                "ordering": ("id",),
            },
        ),
        migrations.CreateModel(
            name="Transaction",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "type",
                    models.CharField(
                        choices=[
                            ("I", "入庫"),
                            ("O", "出庫"),
                            ("T", "拠点間移動"),
                            ("A", "在庫調整"),
                            ("C", "キャンセル"),
                        ],
                        default="I",
                        max_length=2,
                        verbose_name="取引タイプ",
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[("P", "未受領"), ("R", "受領済み")],
                        default="R",
                        max_length=2,
                        verbose_name="状態",
                    ),
                ),
                (
                    "quantity",
                    models.IntegerField(
                        default=1,
                        validators=[django.core.validators.MinValueValidator(0)],
                        verbose_name="数量",
                    ),
                ),
                (
                    "lot",
                    models.CharField(max_length=200, null=True, verbose_name="製造番号"),
                ),
                ("expire_date", models.DateField(null=True, verbose_name="使用期限")),
                (
                    "date_created",
                    models.DateTimeField(auto_now_add=True, verbose_name="作成日時"),
                ),
                ("source_inventory_adjusted", models.BooleanField(default=False)),
                (
                    "dest_site",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="destination_site",
                        to="inventory.site",
                        verbose_name="入庫先",
                    ),
                ),
                (
                    "name",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        to="inventory.drug",
                        verbose_name="医薬品名",
                    ),
                ),
                (
                    "source_site",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="source_site",
                        to="inventory.site",
                        verbose_name="出庫元",
                    ),
                ),
                (
                    "user",
                    models.ForeignKey(
                        default=0,
                        on_delete=django.db.models.deletion.PROTECT,
                        to=settings.AUTH_USER_MODEL,
                        verbose_name="作成者",
                    ),
                ),
                (
                    "unit",
                    models.ForeignKey(
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        to="inventory.unit",
                        verbose_name="単位",
                    ),
                ),
            ],
            options={
                "ordering": ("id",),
            },
        ),
        migrations.CreateModel(
            name="InventoryItem",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "quantity",
                    models.IntegerField(
                        blank=True, default=0, null=True, verbose_name="数量"
                    ),
                ),
                (
                    "lot",
                    models.CharField(max_length=200, null=True, verbose_name="製造番号"),
                ),
                ("expire_date", models.DateField(null=True, verbose_name="使用期限")),
                (
                    "date_created",
                    models.DateTimeField(auto_now_add=True, verbose_name="最終更新日時"),
                ),
                (
                    "name",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        to="inventory.drug",
                        verbose_name="医薬品名",
                    ),
                ),
                (
                    "user",
                    models.ForeignKey(
                        default=0,
                        on_delete=django.db.models.deletion.PROTECT,
                        to=settings.AUTH_USER_MODEL,
                        verbose_name="最終更新者",
                    ),
                ),
                (
                    "site",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        to="inventory.site",
                        verbose_name="拠点",
                    ),
                ),
                (
                    "unit",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        to="inventory.unit",
                        verbose_name="単位",
                    ),
                ),
            ],
            options={
                "ordering": ("id",),
            },
        ),
        migrations.AddField(
            model_name="drug",
            name="unit",
            field=models.ForeignKey(
                blank=True,
                help_text="必須。最小単位優先。確信が持てない場合は、「EA」を選択してください。",
                null=True,
                on_delete=django.db.models.deletion.PROTECT,
                to="inventory.unit",
                verbose_name="単位",
            ),
        ),
        migrations.CreateModel(
            name="UserProfile",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "scanner_mode_enabled",
                    models.BooleanField(default=True, verbose_name="デフォルトでスキャナーモードが有効"),
                ),
                (
                    "default_sort_field",
                    models.CharField(
                        default="date_created",
                        max_length=255,
                        verbose_name="デフォルトの並べ替えのキー",
                    ),
                ),
                (
                    "default_sort_order",
                    models.CharField(
                        choices=[("asc", "昇順"), ("desc", "降順")],
                        default="desc",
                        max_length=4,
                        verbose_name="デフォルトの並べ替え順序",
                    ),
                ),
                (
                    "default_site",
                    models.ForeignKey(
                        blank=True,
                        help_text="ログイン後にユーザーのデフォルトの拠点。",
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        to="inventory.site",
                        verbose_name="デフォルトの拠点",
                    ),
                ),
                (
                    "user",
                    models.OneToOneField(
                        on_delete=django.db.models.deletion.CASCADE,
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "ordering": ("id",),
            },
        ),
        migrations.CreateModel(
            name="SafetyStock",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "min_stock",
                    models.IntegerField(
                        default=1,
                        validators=[django.core.validators.MinValueValidator(0)],
                        verbose_name="安全在庫数（定数）",
                    ),
                ),
                (
                    "drug",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.PROTECT,
                        to="inventory.drug",
                        verbose_name="医薬品名",
                    ),
                ),
                (
                    "site",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.PROTECT,
                        to="inventory.site",
                        verbose_name="拠点",
                    ),
                ),
            ],
            options={
                "ordering": ("drug", "site"),
                "unique_together": {("drug", "site")},
            },
        ),
    ]
